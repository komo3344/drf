{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\ZB-PC087\\\\Desktop\\\\REST-Django-Framwork\\\\drfx\\\\front-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\ZB-PC087\\\\Desktop\\\\REST-Django-Framwork\\\\drfx\\\\front-react\\\\src\\\\pages\\\\Posts.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { URL, Write } from 'pages';\nconst style = {\n  image: {\n    border: '1px solid #ccc',\n    background: '#fefefe'\n  }\n};\n\nclass Posts extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      posts: [],\n      editing: false,\n      writeShowResults: false\n    };\n\n    this.handle_change = e => {\n      const name = e.target.name;\n      const value = e.target.value;\n      this.setState(prevstate => {\n        const newState = _objectSpread({}, prevstate);\n\n        newState[name] = value;\n        return newState;\n      });\n    };\n\n    this.handleDelete = url => {\n      fetch(url, {\n        method: 'DELETE',\n        headers: {\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        }\n      }).then(() => {\n        this.postlist();\n      });\n    };\n\n    this.handleUpdate = id => {\n      this.setState({\n        editing: !this.state.editing\n      });\n      fetch(\"\".concat(URL.posts).concat(id, \"/\")).then(res => res.json()).then(json => {\n        this.setState({\n          id: id,\n          title: json.title,\n          content: json.content,\n          image: json.image\n        });\n      });\n    };\n\n    this.handleModify = (e, data, id) => {\n      this.setState({\n        editing: !this.state.editing\n      });\n      e.preventDefault();\n      var form_data = new FormData();\n      form_data.append('image', data.image);\n      form_data.append('title', data.title);\n      form_data.append('content', data.content);\n      fetch(\"\".concat(URL.posts).concat(id, \"/\"), {\n        method: 'PUT',\n        headers: {\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        },\n        body: form_data\n      }).then(() => {\n        this.postlist();\n      }); // console.log(`${URL.posts}${id}/`)\n      // window.location.reload();\n    };\n\n    this.handle_write = (e, data) => {\n      e.preventDefault();\n      var form_data = new FormData();\n      form_data.append('image', data.image);\n      form_data.append('title', data.title);\n      form_data.append('content', data.content);\n      fetch(URL.posts, {\n        method: 'POST',\n        headers: {\n          Accept: '*/*',\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        },\n        body: form_data\n      }).then(res => {\n        res.json();\n      }).then(json => {\n        this.setState({\n          logged_in: true,\n          displayed_form: ''\n        });\n      }).then(() => {\n        this.postlist();\n      });\n    };\n\n    this.onClick = () => {\n      this.setState({\n        writeShowResults: !this.state.writeShowResults\n      });\n    };\n\n    this.handleImageChange = e => {\n      this.setState({\n        image: e.target.files[0]\n      });\n    };\n  }\n\n  async postlist() {\n    try {\n      const res = await fetch(URL.posts);\n      const posts = await res.json();\n      this.setState({\n        posts\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const res = await fetch(URL.posts);\n      const posts = await res.json();\n      this.setState({\n        posts\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"submit\",\n      value: \"\\uAC8C\\uC2DC\\uBB3C \\uC791\\uC131\",\n      onClick: this.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), this.state.writeShowResults ? React.createElement(Write, {\n      handle_write: this.handle_write,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }) : null), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, this.state.editing ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"\\uC218\\uC815\\uC911\"), React.createElement(\"form\", {\n      onSubmit: e => {\n        this.props.handleModify(e, this.state.id);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"title\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"title\",\n      value: this.state.title,\n      onChange: this.handle_change,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, \"content\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"content\",\n      value: this.state.content,\n      onChange: this.handle_change,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      required: true,\n      ref: \"file\" //필요\n      ,\n      id: \"image\",\n      accept: \"image/*\",\n      type: \"file\",\n      name: \"image\",\n      onChange: this.handleImageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }))) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, \"\\uC6D0\\uB798\\uC791\\uC5C5\"), this.state.posts.map(item => React.createElement(\"div\", {\n      key: item.url,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"\\uC81C\\uBAA9 : \", item.title), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"\\uB0B4\\uC6A9 : \", item.content), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"\\uC791\\uC131\\uC790 : \", item.owner), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, \"\\uC0DD\\uC131\\uC77C : \", item.created_at), React.createElement(\"img\", {\n      src: item.image,\n      alt: \"No img\",\n      height: 240,\n      width: 240,\n      style: style.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: () => {\n        this.handleDelete(item.url);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }, \"\\uC0AD\\uC81C\"), React.createElement(\"button\", {\n      onClick: () => {\n        this.handleUpdate(item.id);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"\\uC218\\uC815\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }))), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \"Home\")))));\n  }\n\n}\n\nexport default Posts;","map":{"version":3,"sources":["C:\\Users\\ZB-PC087\\Desktop\\REST-Django-Framwork\\drfx\\front-react\\src\\pages\\Posts.js"],"names":["React","Component","Link","URL","Write","style","image","border","background","Posts","state","posts","editing","writeShowResults","handle_change","e","name","target","value","setState","prevstate","newState","handleDelete","url","fetch","method","headers","Authorization","localStorage","getItem","then","postlist","handleUpdate","id","res","json","title","content","handleModify","data","preventDefault","form_data","FormData","append","body","handle_write","Accept","logged_in","displayed_form","onClick","handleImageChange","files","console","log","componentDidMount","render","props","map","item","owner","created_at"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { URL, Write } from 'pages';\r\n\r\nconst style = {\r\n    image: {\r\n        border: '1px solid #ccc',\r\n        background: '#fefefe',\r\n    },\r\n};\r\nclass Posts extends Component {\r\n    state = {\r\n        posts: [],\r\n        editing : false,\r\n        writeShowResults: false\r\n    };\r\n\r\n    handle_change = e => {\r\n        const name = e.target.name;\r\n        const value = e.target.value;\r\n        this.setState(prevstate => {\r\n          const newState = { ...prevstate };\r\n          newState[name] = value;\r\n          return newState;\r\n        });\r\n      };\r\n\r\n    handleDelete = url => {\r\n        fetch(url, {\r\n            method: 'DELETE',\r\n            headers: {\r\n                Authorization: `JWT ${localStorage.getItem('token')}`\r\n            }\r\n        }).then(() => {\r\n            this.postlist()\r\n        })\r\n    }\r\n    async postlist() {\r\n        try {\r\n            const res = await fetch(URL.posts);\r\n            const posts = await res.json();\r\n            this.setState({\r\n                posts\r\n            });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    }\r\n\r\n    handleUpdate = (id) => {\r\n        this.setState({\r\n            editing : !this.state.editing\r\n        })\r\n        fetch(`${URL.posts}${id}/`)\r\n        .then(res => res.json())\r\n        .then(json => {\r\n            this.setState({\r\n                id : id,\r\n                title : json.title,\r\n                content : json.content,\r\n                image : json.image,\r\n                \r\n            })\r\n        })\r\n        \r\n    }\r\n\r\n    handleModify = (e, data, id) => {\r\n        this.setState({\r\n            editing : !this.state.editing\r\n        })\r\n        e.preventDefault();\r\n        var form_data = new FormData();\r\n        form_data.append('image', data.image);\r\n        form_data.append('title', data.title);\r\n        form_data.append('content', data.content);\r\n\r\n        fetch(`${URL.posts}${id}/`,{\r\n            method: 'PUT',\r\n            headers: {\r\n                Authorization: `JWT ${localStorage.getItem('token')}`\r\n            },\r\n            body: form_data\r\n        }).then(() =>{\r\n            this.postlist()\r\n        })\r\n        // console.log(`${URL.posts}${id}/`)\r\n        // window.location.reload();\r\n        \r\n    }\r\n\r\n    async componentDidMount() {\r\n        try {\r\n            const res = await fetch(URL.posts);\r\n            const posts = await res.json();\r\n            this.setState({\r\n                posts\r\n            });\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    }\r\n    handle_write = (e, data) => {\r\n        e.preventDefault();\r\n        var form_data = new FormData();\r\n\r\n        form_data.append('image', data.image);\r\n        form_data.append('title', data.title);\r\n        form_data.append('content', data.content);      \r\n\r\n        fetch(URL.posts, {\r\n            method: 'POST',\r\n            headers: {\r\n                Accept : '*/*',\r\n                Authorization: `JWT ${localStorage.getItem('token')}`\r\n            },\r\n            body: form_data\r\n            \r\n        })\r\n            .then(res => {\r\n                res.json()\r\n            })\r\n            .then(json => {\r\n                this.setState({\r\n                    logged_in: true,\r\n                    displayed_form: '',\r\n                });\r\n            }).then(()=>{\r\n                this.postlist()\r\n            })\r\n    }\r\n    \r\n    onClick = () =>{\r\n        this.setState({\r\n            writeShowResults : !this.state.writeShowResults\r\n        })\r\n    }\r\n    handleImageChange = e => {\r\n        this.setState({\r\n          image: e.target.files[0]\r\n        })\r\n      }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <div>\r\n                <input type=\"submit\" value=\"게시물 작성\" onClick={this.onClick} />\r\n                { this.state.writeShowResults ? <Write handle_write={this.handle_write} /> : null }\r\n                </div>\r\n\r\n                <div>\r\n                {this.state.editing\r\n                    ? (\r\n                        <div>\r\n                            <h5>수정중</h5>\r\n                            <form onSubmit={(e) => {this.props.handleModify(e, this.state.id)}}>\r\n                                <label htmlFor=\"title\">title</label>\r\n                                <input\r\n                                type=\"text\"\r\n                                name=\"title\"\r\n                                value={this.state.title}\r\n                                onChange={this.handle_change}\r\n                                />\r\n                                <label htmlFor=\"content\">content</label>\r\n                                <input\r\n                                type=\"text\"\r\n                                name=\"content\"\r\n                                value={this.state.content}\r\n                                onChange={this.handle_change}\r\n                                /><br />\r\n                                <input\r\n                                required\r\n                                ref=\"file\" //필요\r\n                                id=\"image\" \r\n                                accept=\"image/*\"\r\n                                type=\"file\"\r\n                                name=\"image\"\r\n                                onChange={this.handleImageChange}\r\n                                />\r\n                                <input type=\"submit\" />\r\n                            </form>\r\n                        </div>\r\n                        )\r\n                    : (\r\n                        <div>\r\n                            <h5>원래작업</h5>        \r\n                            {this.state.posts.map(item =>\r\n                                (\r\n                                    <div key={item.url}>\r\n                                        <h4>제목 : {item.title}</h4>\r\n                                        <p>내용 : {item.content}</p>\r\n                                        <p>작성자 : {item.owner}</p>\r\n                                        <p>생성일 : {item.created_at}</p>\r\n                                        <img\r\n                                         src={item.image}\r\n                                         alt='No img'\r\n                                         height={240}\r\n                                         width={240}\r\n                                         style={style.image\r\n                                        }\r\n                                        /><br />\r\n                           \r\n                                        <button onClick={() => {this.handleDelete(item.url)}}>삭제</button>\r\n                                        <button onClick={() => {this.handleUpdate(item.id)}}>수정</button>\r\n                                        <br /><br />\r\n                                    </div>\r\n                                )\r\n                            )\r\n                }           \r\n                <p><Link to='/'>Home</Link></p>\r\n                        </div>\r\n                        )\r\n                }\r\n                </div>\r\n                \r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default Posts;"]},"metadata":{},"sourceType":"module"}