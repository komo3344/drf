{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\ZB-PC087\\\\Desktop\\\\REST-Django-Framwork\\\\drfx\\\\front-react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\ZB-PC087\\\\Desktop\\\\REST-Django-Framwork\\\\drfx\\\\front-react\\\\src\\\\pages\\\\Posts.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { URL, Write } from 'pages';\nconst style = {\n  image: {\n    border: '1px solid #ccc',\n    background: '#fefefe'\n  }\n};\n\nclass Posts extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      posts: [],\n      editing: false,\n      writeShowResults: false\n    };\n\n    this.handle_change = e => {\n      const name = e.target.name;\n      const value = e.target.value;\n      this.setState(prevstate => {\n        const newState = _objectSpread({}, prevstate);\n\n        newState[name] = value;\n        return newState;\n      });\n    };\n\n    this.handleDelete = url => {\n      fetch(url, {\n        method: 'DELETE',\n        headers: {\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        }\n      }).then(() => {\n        this.postlist();\n      });\n    };\n\n    this.handleUpdate = id => {\n      this.setState({\n        editing: !this.state.editing\n      });\n      fetch(\"\".concat(URL.posts).concat(id, \"/\")).then(res => res.json()).then(json => {\n        this.setState({\n          id: id,\n          title: json.title,\n          content: json.content,\n          image: json.image\n        });\n      });\n    };\n\n    this.handleModify = (e, data) => {\n      this.setState({\n        editing: !this.state.editing\n      });\n      e.preventDefault();\n      var form_data = new FormData();\n      form_data.append('image', data.image);\n      form_data.append('title', data.title);\n      form_data.append('content', data.content);\n      fetch(\"\".concat(URL.posts).concat(this.state.id, \"/\"), {\n        method: 'PUT',\n        headers: {\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        },\n        body: form_data\n      }).then(() => {\n        this.postlist();\n      });\n    };\n\n    this.handle_write = (e, data) => {\n      e.preventDefault();\n      var form_data = new FormData();\n      form_data.append('image', data.image);\n      form_data.append('title', data.title);\n      form_data.append('content', data.content);\n      fetch(URL.posts, {\n        method: 'POST',\n        headers: {\n          Accept: '*/*',\n          Authorization: \"JWT \".concat(localStorage.getItem('token'))\n        },\n        body: form_data\n      }).then(res => {\n        res.json();\n      }).then(json => {\n        this.setState({\n          logged_in: true,\n          displayed_form: ''\n        });\n      }).then(() => {\n        this.postlist();\n      });\n    };\n\n    this.onClick = () => {\n      this.setState({\n        writeShowResults: !this.state.writeShowResults\n      });\n    };\n\n    this.handleImageChange = e => {\n      this.setState({\n        image: e.target.files[0]\n      });\n    };\n  }\n\n  async postlist() {\n    try {\n      const res = await fetch(URL.posts);\n      const posts = await res.json();\n      this.setState({\n        posts\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  async componentDidMount() {\n    try {\n      const res = await fetch(URL.posts);\n      const posts = await res.json();\n      this.setState({\n        posts\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"submit\",\n      value: \"\\uAC8C\\uC2DC\\uBB3C \\uC791\\uC131\",\n      onClick: this.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), this.state.writeShowResults ? React.createElement(Write, {\n      handle_write: this.handle_write,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }) : null), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, this.state.editing ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"\\uC218\\uC815\\uC911\"), React.createElement(\"form\", {\n      onSubmit: e => {\n        this.handleModify(e, this.state);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"title\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"title\",\n      value: this.state.title,\n      onChange: this.handle_change,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"content\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"content\",\n      value: this.state.content,\n      onChange: this.handle_change,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      required: true,\n      ref: \"file\" //필요\n      ,\n      id: \"image\",\n      accept: \"image/*\",\n      type: \"file\",\n      name: \"image\",\n      onChange: this.handleImageChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }))) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, \"\\uC6D0\\uB798\\uC791\\uC5C5\"), this.state.posts.map(item => React.createElement(\"div\", {\n      key: item.url,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"\\uC81C\\uBAA9 : \", item.title), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"\\uB0B4\\uC6A9 : \", item.content), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \"\\uC791\\uC131\\uC790 : \", item.owner), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, \"\\uC0DD\\uC131\\uC77C : \", item.created_at), React.createElement(\"img\", {\n      src: item.image,\n      alt: \"No img\",\n      height: 240,\n      width: 240,\n      style: style.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: () => {\n        this.handleDelete(item.url);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, \"\\uC0AD\\uC81C\"), React.createElement(\"button\", {\n      onClick: () => {\n        this.handleUpdate(item.id);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, \"\\uC218\\uC815\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }))), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"Home\")))));\n  }\n\n}\n\nexport default Posts;","map":{"version":3,"sources":["C:\\Users\\ZB-PC087\\Desktop\\REST-Django-Framwork\\drfx\\front-react\\src\\pages\\Posts.js"],"names":["React","Component","Link","URL","Write","style","image","border","background","Posts","state","posts","editing","writeShowResults","handle_change","e","name","target","value","setState","prevstate","newState","handleDelete","url","fetch","method","headers","Authorization","localStorage","getItem","then","postlist","handleUpdate","id","res","json","title","content","handleModify","data","preventDefault","form_data","FormData","append","body","handle_write","Accept","logged_in","displayed_form","onClick","handleImageChange","files","console","log","componentDidMount","render","map","item","owner","created_at"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { URL, Write } from 'pages';\r\n\r\nconst style = {\r\n  image: {\r\n    border: '1px solid #ccc',\r\n    background: '#fefefe',\r\n  },\r\n};\r\nclass Posts extends Component {\r\n  state = {\r\n    posts: [],\r\n    editing: false,\r\n    writeShowResults: false\r\n  };\r\n\r\n  handle_change = e => {\r\n    const name = e.target.name;\r\n    const value = e.target.value;\r\n    this.setState(prevstate => {\r\n      const newState = { ...prevstate };\r\n      newState[name] = value;\r\n      return newState;\r\n    });\r\n  };\r\n\r\n  handleDelete = url => {\r\n    fetch(url, {\r\n      method: 'DELETE',\r\n      headers: {\r\n        Authorization: `JWT ${localStorage.getItem('token')}`\r\n      }\r\n    }).then(() => {\r\n      this.postlist()\r\n    })\r\n  }\r\n  async postlist() {\r\n    try {\r\n      const res = await fetch(URL.posts);\r\n      const posts = await res.json();\r\n      this.setState({\r\n        posts\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  handleUpdate = (id) => {\r\n    this.setState({\r\n      editing: !this.state.editing\r\n    })\r\n    fetch(`${URL.posts}${id}/`)\r\n      .then(res => res.json())\r\n      .then(json => {\r\n        this.setState({\r\n          id: id,\r\n          title: json.title,\r\n          content: json.content,\r\n          image: json.image,\r\n\r\n        })\r\n      })\r\n\r\n  }\r\n\r\n  handleModify = (e, data) => {\r\n    this.setState({\r\n      editing: !this.state.editing\r\n    })\r\n    e.preventDefault();\r\n    var form_data = new FormData();\r\n    form_data.append('image', data.image);\r\n    form_data.append('title', data.title);\r\n    form_data.append('content', data.content);\r\n\r\n    fetch(`${URL.posts}${this.state.id}/`, {\r\n      method: 'PUT',\r\n      headers: {\r\n        Authorization: `JWT ${localStorage.getItem('token')}`\r\n      },\r\n      body: form_data\r\n    }).then(() => {\r\n      this.postlist()\r\n    })\r\n\r\n  }\r\n\r\n  async componentDidMount() {\r\n    try {\r\n      const res = await fetch(URL.posts);\r\n      const posts = await res.json();\r\n      this.setState({\r\n        posts\r\n      });\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  handle_write = (e, data) => {\r\n    e.preventDefault();\r\n    var form_data = new FormData();\r\n\r\n    form_data.append('image', data.image);\r\n    form_data.append('title', data.title);\r\n    form_data.append('content', data.content);\r\n\r\n    fetch(URL.posts, {\r\n      method: 'POST',\r\n      headers: {\r\n        Accept: '*/*',\r\n        Authorization: `JWT ${localStorage.getItem('token')}`\r\n      },\r\n      body: form_data\r\n\r\n    })\r\n      .then(res => {\r\n        res.json()\r\n      })\r\n      .then(json => {\r\n        this.setState({\r\n          logged_in: true,\r\n          displayed_form: '',\r\n        });\r\n      }).then(() => {\r\n        this.postlist()\r\n      })\r\n  }\r\n\r\n  onClick = () => {\r\n    this.setState({\r\n      writeShowResults: !this.state.writeShowResults\r\n    })\r\n  }\r\n  handleImageChange = e => {\r\n    this.setState({\r\n      image: e.target.files[0]\r\n    })\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div>\r\n          <input type=\"submit\" value=\"게시물 작성\" onClick={this.onClick} />\r\n          {this.state.writeShowResults ? <Write handle_write={this.handle_write} /> : null}\r\n        </div>\r\n\r\n        <div>\r\n          {this.state.editing\r\n            ? (\r\n              <div>\r\n                <h5>수정중</h5>\r\n                <form onSubmit={(e) => { this.handleModify(e, this.state) }}>\r\n                  <label htmlFor=\"title\">title</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    name=\"title\"\r\n                    value={this.state.title}\r\n                    onChange={this.handle_change}\r\n                  />\r\n                  <label htmlFor=\"content\">content</label>\r\n                  <input\r\n                    type=\"text\"\r\n                    name=\"content\"\r\n                    value={this.state.content}\r\n                    onChange={this.handle_change}\r\n                  /><br />\r\n                  <input\r\n                    required\r\n                    ref=\"file\" //필요\r\n                    id=\"image\"\r\n                    accept=\"image/*\"\r\n                    type=\"file\"\r\n                    name=\"image\"\r\n                    onChange={this.handleImageChange}\r\n                  />\r\n                  <input type=\"submit\" />\r\n                </form>\r\n              </div>\r\n            )\r\n            : (\r\n              <div>\r\n                <h5>원래작업</h5>\r\n                {this.state.posts.map(item =>\r\n                  (\r\n                    <div key={item.url}>\r\n                      <h4>제목 : {item.title}</h4>\r\n                      <p>내용 : {item.content}</p>\r\n                      <p>작성자 : {item.owner}</p>\r\n                      <p>생성일 : {item.created_at}</p>\r\n                      <img\r\n                        src={item.image}\r\n                        alt='No img'\r\n                        height={240}\r\n                        width={240}\r\n                        style={style.image\r\n                        }\r\n                      /><br />\r\n\r\n                      <button onClick={() => { this.handleDelete(item.url) }}>삭제</button>\r\n                      <button onClick={() => { this.handleUpdate(item.id) }}>수정</button>\r\n                      <br /><br />\r\n                    </div>\r\n                  )\r\n                )\r\n                }\r\n                <p><Link to='/'>Home</Link></p>\r\n              </div>\r\n            )\r\n          }\r\n        </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default Posts;"]},"metadata":{},"sourceType":"module"}